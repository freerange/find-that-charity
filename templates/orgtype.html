{% extends 'base.html' %}
{% set heading = query|list_to_string %}
{% set subtitle = "{:,.0f} random organisations out of {:,.0f}".format(res.hits|length, res.total) %}

{% block content %}
<div class="columns">
  <div class="column">
        {% include '_search_results.html' %}
  </div>
  <div class="column is-one-third content">
    <h4>Related organisation types</h4>
    <div class="field is-grouped is-grouped-multiline">
        {% for t in aggs.group_by_type.buckets if t.key not in term and t.key in key_types %}
            <div class="control" style="width: 100%;">
                <div class="tags has-addons">
                    <a class="tag is-light is-medium" href="/orgid/type/{{ t.key }}">{{ t.key }}</a>
                    <span class="tag is-info is-medium">{{ "{:,.0f}".format(t.doc_count) }}</span>
                </div>
            </div>
        {% endfor %}
        {% for t in aggs.group_by_type.buckets if t.key not in term and t.key not in key_types %}
            <div class="control">
                <div class="tags has-addons">
                    <a class="tag is-light is-small" href="/orgid/type/{{ t.key }}">{{ t.key }}</a>
                    <span class="tag is-info is-small">{{ "{:,.0f}".format(t.doc_count) }}</span>
                </div>
            </div>
        {% endfor %}
    </div>
    <h4>Data sources</h4>
    <div class="field is-grouped is-grouped-multiline">
        {% for t in aggs.group_by_source.buckets if sources.get(t.key) %}
            <div class="control" style="width: 100%;">
                <div class="tags has-addons">
                    <a class="tag is-light is-medium" href="/orgid/source/{{ t.key }}">{{ sources[t.key].publisher.name }}</a>
                    <span class="tag is-info is-medium">{{ "{:,.0f}".format(t.doc_count) }}</span>
                </div>
            </div>
        {% endfor %}
    </div>
  </div>
</div>
{% endblock %}